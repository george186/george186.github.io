---

title: 日常练习13——Unicode编码安全问题

date: 2021-04-07 23:10:11

tags: 练习

categories: test61

---
今天刷题刷到一个小知识点，记录一下.   

# [ASIS 2019]Unicorn shop  

题目已经给出提示和unicode编码有关。  

打开题目，发现是一个商店，让我们买马。  

[![](https://img.imgdb.cn/item/607003a08322e6675c295eb9.png)](https://img.imgdb.cn/item/607003a08322e6675c295eb9.png)  

可以看到最后一匹马明显与众不同要花1337，所以大概率是flag了，我们先测试买前面的几匹马。  

我们尝试买第一匹马，输入1，2后却是错误回显。   

[![](https://img.imgdb.cn/item/607004588322e6675c2a0bb3.png)](https://img.imgdb.cn/item/607004588322e6675c2a0bb3.png)  

说是没有这个商品，我们改变一下输入的金钱的格式：输入2.0.  

[![](https://img.imgdb.cn/item/607004e78322e6675c2a8a86.png)](https://img.imgdb.cn/item/607004e78322e6675c2a8a86.png)  

提示我们输入的字符只能有一位。  

那么这道题要考我们的就很明显了，flag需要1337才能买到，而我们输入的金钱的字符只能有一位，我们需要绕过这个字符长度限制来买到flag，那么有什么字符是1位长度的并且数值大于1337的呢？   

题目开头就提示了这道题和unicode有关，那么我们就需要了解一下unicode编码。  

### unicode编码

	unicode编码其实也不陌生了，说的简单一点unicode编码就好比一部大字典，只不过这部字典里包含了世界上所有的字符。  
	
	为什么要有unicode编码呢？这是因为ASCII码对于英文字母来说是足够用了但是用来表示其他语言，128 个字符是远远不够的。而对于欧洲国家不同的国家的字符集可能不同，就算它们都能用 256 个字符表示全，但是同一个码点（也就是 8 位二进制数）表示的字符可能可能不同。例如，144 在阿拉伯人的 ASCII 码中是 گ，而在俄罗斯的 ASCII 码中是 ђ。对于亚洲的语言来说，一个字节明显不够用，要用两个字节来储存字符。  
	
	而这样各不相同的编码对于开发者来说是痛苦的，于是就有了unicode编码。  
	
	Unicode 当然是一本很厚的字典，记录着世界上所有字符对应的一个数字。具体是怎样的对应关系，又或者说是如何进行划分的，就不是我们考虑的问题了，我们只用知道 Unicode 给所有的字符指定了一个数字用来表示该字符。
	
	对于 Unicode 有一些误解，它仅仅只是一个字符集，规定了符合对应的二进制代码，至于这个二进制代码如何存储则没有任何规定。它的想法很简单，就是为每个字符规定一个用来表示该字符的数字，仅此而已。

了解了unicode编码后我们就可以从这上面下文章了，我们要做的也就是找到一个一位长度的unicode字符并且它的值要大于1337，这样就可以绕过限制。  

这里推荐这个网站上面可以查到所有的unicode字符。   

[unicode字符查询](https://www.compart.com/en/unicode/U+2181)  

这里我找到的是这个字符：  

[![](https://img.imgdb.cn/item/60700c278322e6675c3137e7.png)](https://img.imgdb.cn/item/60700c278322e6675c3137e7.png)  

可以看到这个字符的值是50000，大于1337，并且长度是1，符合要求，我们直接输入money为这个字符就可以成功买到flag。  

[![](https://img.imgdb.cn/item/60700c938322e6675c31ab39.png)](https://img.imgdb.cn/item/60700c938322e6675c31ab39.png)  

下面简单讲一下绕过的原理，首先我们查看源码。  

[![](https://img.imgdb.cn/item/60700cd98322e6675c31e28c.png)](https://img.imgdb.cn/item/60700cd98322e6675c31e28c.png)  

可以看到源码中提示我们uft-8这个很重要，而这个就是unicode编码的一种编码方式（这也告诉我们这道题可以用unicode编码的字符）。在这道题目中，当我们上传上面那个字符的uft=8的编码时，后端在处理时发现无法将其转化为ASCII码，于是会将其解析为unicode码，而这个unicode码代表的是50000，正好大于1337，于是便能成功购买flag。  

# 小结  

这道题算是一个小的知识点吧，告诉我了关于unicode编码的一些安全问题，可以当作一个小知识记着，以防以后的题目中遇到不会。  

下面附上讲解unicode编码安全的一些博客。  

[浅谈Unicode设计的安全性](https://xz.aliyun.com/t/5402#toc-0)  
[Unicode等价性浅谈](https://blog.lyle.ac.cn/2018/10/29/unicode-normalization/)